<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>State of Oskari 8/2019</title>

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/black.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/monokai.css" />
<style>
</style>
    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = window.location.search.match(/print-pdf/gi)
        ? "css/print/pdf.css"
        : "css/print/paper.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
            <img  src="images/oskari_k.svg" style="width: 70%; border:0; background-color:transparent; " />
          <h2>Year in review 8/2019</h2>
          <p>Sami MÃ¤kinen - NLS Finland</p>
        </section>
        <section data-markdown>
          ### Oskari
          
          - Software library/framework
          - Server: Java built with Maven
          - Frontend: JS built with Webpack
          - Requires:
            - PostgreSQL/PostGIS
            - Redis
            - (Spatial Data Infrastructure)
        </section>
        <section>
            <h4>Arctic-SDI geoportal</h4>
            <img  src="images/asdi.png" style="max-width: 80%; border:0;" />
        </section>
        <section>
            <h4>National geoportal Finland</h4>
            <img  src="images/pti.png" style="max-width: 80%; border:0;" />
        </section>
        <section data-markdown>
          ### Repository arrangements

          - oskari-server
            - (oskari-server-extension-template)
            - sample-server-extension
          - oskari-frontend
            - sample-application
        </section>
        <section>
          <h4>Frontend builds</h4>
          
          <p class="fragment shrink fade-out"><img src="images/grunt-logo.svg" style="max-width: 20%; border:0; background-color:transparent" /> </p>
          <p class="fragment grow fade-in current-visible"><img src="images/webpack-logo.svg"  style="max-width: 50%; border:0; background-color:transparent"/> </p>
           
        </section>
        <section data-markdown>
          #### Frontend builds
          
          - Babel
          - ES6 modules
          - imports
          - dynamic imports
          - npm dependencies
          - React support
        </section>
        <section data-markdown>
          #### Imports: bundles
          Then/now:
          ```json
          "scripts": [{
            "type": "text/javascript",
            "src": ".../mapping/drawtools/instance.js"
          }, {
            "type": "text/css",
            "src": ".../mapping/drawtools/resources/css/style.css"
          }, { ... }]
          ```
          Now/future:
          ```Javascript
          import { DrawTools } from './instance';
          import './resources/css/style.css';
          ```
        </section>
        <section data-markdown>
          #### Imports: applications
          Then (minifierAppSetup.json):
          ```json
          {
            "bundlename" : "drawtools",
            "metadata" : {
              "Import-Bundle" : {
                "drawtools" : {
                  "bundlePath" : ".../mapping/ol3/"
                }
              }
            }
          }
          ```
          Now (main.js):
          ```Javascript
          import 'oskari-loader!oskari-frontend/.../drawtools/bundle.js';
          ```
        </section>
        <section data-markdown>
          ### New goodies: React

          - keeping it small and simple
          - named imports
          - use props as much as possible
          - state kept at bundle instance
          - "mutator" objects from services
        </section>
        <section data-markdown>
          ### First steps in React

          - language selector
          - thematic maps legend
          - map layer admin
        </section>
        <section data-markdown>
          ### New goodies for UI

          - Ant Design
            - "The world's second most popular React UI framework"
          - styled-components
          - Challenge: multiple styling libs / style conficts
        </section>
        <section data-markdown>
            ### New goodies

            - Storybook
            - Jest
         </section>
        <section data-markdown>
          ### Pull requests
          - Travis CI
          - ESLint
          - Jest
          - Junit
          - Oracle JDK 11, OpenJDK 8 & 11
        </section>
        <section data-markdown>
          ### WFS integrations

          - Complete rewrite
          - MVT / GeoJSON
          - WFS 3 support
        </section>
        <section>
            <h3>Slow services...</h3>
            <ul>
              <li>Hystrix</li>
              <li>Service Worker</li>
            </ul><br />
            <img  src="images/slow.gif" style="max-width: 100%; border:0;" />
        </section>
        <section data-markdown>
          ### Vector features

          - https://oskari.org/documentation/examples/oskari-style
          - Mapbox styles for MVT
          - Clustering
          - Color animations
          - Hover
          - Performance improvements
        </section>
        <section data-markdown>
#### Thematic maps -> Timon esitykseen
- Thematic maps diagrams
- Thematic maps manual classification
- Time series
        </section>
        <section data-markdown>
#### User geolocation
- User geolocation can no longer move the map outside the map extent
- User location now supports accuracy for location and configurable zoom level.
- User location detection now supports tracking and drawing the route on map (no UI for this, usable via RPC)
        </section>
        <section data-markdown>
#### Other improvements?
- Map rotation is now saved in state (saved views/embedded maps/page reload).
- French & Russian localizations
- Toolbar button logic rewrite https://github.com/oskariorg/oskari-frontend/pull/754
- Support for Bing maps added (required API key from Bing).
- initial 3d support, builds on isFeatureSupported that was introduced on isSRSsupported
- Appsetup can now have customized publish template
- language selector
- Session timeout notification improvements
- Improved performance of the layer listing with long layer lists
- Improved performance of the feature data table when multiple features are selected
- Oskari.getNumberFormatter()
- API doc improvements
- measurement function now works properly for MultiPolygons and degree based projections
- Improvements to drawtools.
- Publisher tools handling and resuming normal operations after publisher has been improved.
- Improved placement for UI-elements/plugins that are shown on top of the map.
        </section>
        <section>
          <h4>Server stuff?</h4>
        </section>
        <section data-markdown>
          
- csrf added  -> samesite cookie (etc 3rd party cookie handling)
- improvements to end-user registration
- concept of internal layers
- layer proxy improvements
- support vector tile based layers
- skip intro & map rotation params on urls
- Jetty 9 upgrade (1.50 similar to 1.49 but includes changes to transport to work with current Jetty version)
- startup removed from appsetups
- KML parsing improved
- setup app improved (disabled modules are no longer populated, SRS populated properly and bounds set)
- login redirects to referer instead of geoportal (enables login on embedded maps/views)
- Spring configurations/annotations are now scanned from org.oskari.* packages in addition to fi.nls.oskari.*
- Compilation of codebase is now tested with OpenJDK 8 & 11 and Oracle Java 11
- Enabled async controllers
- fixes to analysis functionality

- appsetups specific publish templates!! -> 3d
- inital support for in-memory test database setup (https://github.com/oskariorg/oskari-server/pull/403)

thematic maps refactoring
- mapstats removal
- geojson from resources files
- filter out data without labels
- localization options added
- region sets now have an order
- initial support for thematic datasource UN stats (https://unstats.un.org/home/)
- improvements for thematic datasource UN stats (get data to figure out options for users)

search channels 
- validation error handling improved
- removed nls search channels
- OSM channel supports bbox filter to limit results 


printout
- rewrite impl
- logo on pdf customizable
- support for current layer types (user content etc)
- fixed scale line 

IOHelper
- urlencoding

Error handling
- CSW parsing
- migrations error handling (app won't start in partially successful migrations between versions)
- layer coverage information can now be ignored (config option)
- classpath conflicts with libraries fixed

Libraries:
- jQuery 1.10.2 to 3.3.1 
- Log4j 1.x -> 2.x
- Geotools 14.2 -> 19.2
- Ibatis -> MyBatis
- CometD 2.x -> 4.x
- Jackson 1.x dropped

Sample app lifecycle
- sample -> example
- example -> sample in different repository
- Java 9+ (mocking for junit)

WFS-integration:
- replacement for transport (removing Jetty requirement as server software)
- vector features as geojson or Mapbox vector tiles for browser instead of binary (admin selectable)
- Supports feature caching (balancing between too many requests to services vs max zoom level)
- Protects services with circuit breaker (Hystrix) like transport
- styling options improved (SLD can't be used) for all vector features shown on Oskari
- complex properties support in mvt
- localization of property names
- permissions for user content rewrite
- WFS 3 support

Documentation:
- oskari.org/db

Problems:
- package.json versions prevent demo.oskari.org frontend build (webpack config doesn't work with the version package.json allows)
- service worker for WFS-integration
        </section>
        <section>
          <h4>Jetty 9 + Java 9+ support</h4>
        </section>
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        history: true,
        dependencies: [
          { src: "plugin/markdown/marked.js" },
          { src: "plugin/markdown/markdown.js" },
          { src: "plugin/notes/notes.js", async: true },
          { src: "plugin/highlight/highlight.js", async: true }
        ]
      });
    </script>
  </body>
</html>
